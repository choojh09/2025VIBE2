import streamlit as st
import html

# --- 질문지 구성 (60문항) ---
QUESTIONS = [
    ("나는 혼자보다는 여러 사람과 있을 때 에너지를 얻는다.", "E"),
    ("나는 혼자 있는 시간이 필요하고, 그 시간을 즐긴다.", "I"),
    ("나는 구체적이고 사실적인 정보를 선호한다.", "S"),
    ("나는 직관이나 영감에 의존하는 편이다.", "N"),
    ("나는 의사결정 시 논리와 분석을 중시한다.", "T"),
    ("나는 사람들의 감정과 조화를 고려하여 결정한다.", "F"),
    ("나는 계획적으로 일처리하고 마감일을 잘 지킨다.", "J"),
    ("나는 융통성 있게 상황에 맞게 행동하는 편이다.", "P"),
    ("나는 새로운 사람들과 쉽게 어울린다.", "E"),
    ("나는 친해지기까지 시간이 오래 걸린다.", "I"),
    ("나는 현재 일어나는 일에 집중한다.", "S"),
    ("나는 미래에 대해 자주 생각한다.", "N"),
    ("나는 토론할 때 감정보다는 주장을 우선시한다.", "T"),
    ("나는 누군가 힘들어 보이면 쉽게 공감한다.", "F"),
    ("나는 일을 시작하기 전에 계획부터 세운다.", "J"),
    ("나는 상황을 보며 즉흥적으로 결정하는 편이다.", "P"),
    ("나는 주말에 약속이 많으면 기분이 좋아진다.", "E"),
    ("나는 혼자 쉬는 주말이 더 좋다.", "I"),
    ("나는 자세하고 구체적인 지시가 편하다.", "S"),
    ("나는 자유롭게 상상하고 구상하는 것이 좋다.", "N"),
    ("나는 논리적인 오류를 쉽게 찾는다.", "T"),
    ("나는 누군가의 기분을 잘 알아차린다.", "F"),
    ("나는 마감일보다 일찍 끝내는 것을 선호한다.", "J"),
    ("나는 마감 직전까지 집중이 잘 안 된다.", "P"),
    ("나는 많은 사람들과 어울릴수록 즐겁다.", "E"),
    ("나는 소수의 사람들과 깊은 대화를 선호한다.", "I"),
    ("나는 실제 경험을 중시한다.", "S"),
    ("나는 상상 속 이야기를 좋아한다.", "N"),
    ("나는 문제의 원인을 분석하려 한다.", "T"),
    ("나는 문제를 겪는 사람의 입장에서 본다.", "F"),
    ("나는 일의 우선순위를 미리 정한다.", "J"),
    ("나는 그때그때 우선순위가 바뀐다.", "P"),
    ("나는 처음 보는 사람에게도 말을 잘 건다.", "E"),
    ("나는 낯선 사람 앞에서 말수가 줄어든다.", "I"),
    ("나는 설명서를 꼼꼼히 읽는다.", "S"),
    ("나는 사용하면서 배우는 편이다.", "N"),
    ("나는 객관적인 기준이 중요하다고 생각한다.", "T"),
    ("나는 상대방의 입장을 고려하는 것이 중요하다 생각한다.", "F"),
    ("나는 일정을 정리한 플래너를 자주 쓴다.", "J"),
    ("나는 하고 싶은 일을 먼저 한다.", "P"),
    ("나는 빠르게 친해지는 편이다.", "E"),
    ("나는 천천히 관계를 쌓는 편이다.", "I"),
    ("나는 눈에 보이는 결과가 있어야 안심된다.", "S"),
    ("나는 가능성과 미래를 보는 것을 좋아한다.", "N"),
    ("나는 이성적으로 행동하려 노력한다.", "T"),
    ("나는 마음이 끌리는 쪽으로 행동한다.", "F"),
    ("나는 무언가를 결정할 때 고민을 오래 하지 않는다.", "J"),
    ("나는 결정을 미루는 편이다.", "P"),
    ("나는 사람들과 함께 있을수록 에너지가 생긴다.", "E"),
    ("나는 혼자 있어야 에너지가 회복된다.", "I"),
    ("나는 현실적이고 실용적인 것을 중시한다.", "S"),
    ("나는 이상적이고 창의적인 것을 좋아한다.", "N"),
    ("나는 규칙을 중시한다.", "T"),
    ("나는 관계를 중시한다.", "F"),
    ("나는 체계적인 것을 좋아한다.", "J"),
    ("나는 자유로운 것이 더 좋다.", "P")
]

# --- MBTI 계산 로직 ---
if "scores" not in st.session_state:
    st.session_state.scores = {t: 0 for t in ["E", "I", "S", "N", "T", "F", "J", "P"]}

st.set_page_config(page_title="MBTI 직업 추천", layout="wide")
st.title("🔍 MBTI 기반 진로 추천 웹사이트")
st.markdown("60개의 문항에 답변하여 본인의 성향을 파악하고, 적절한 직업을 추천받을 수 있습니다.")

with st.form("mbti_form"):
    for idx, (question, t) in enumerate(QUESTIONS):
        choice = st.radio(f"{idx+1}. {question}", ("그렇다", "아니다"), key=f"q{idx}")
        if choice == "그렇다":
            st.session_state.scores[t] += 1
    submitted = st.form_submit_button("결과 보기")

# --- MBTI 유형 결정 및 직업 추천 ---
if submitted:
    mbti = ""
    mbti += "E" if st.session_state.scores["E"] >= st.session_state.scores["I"] else "I"
    mbti += "S" if st.session_state.scores["S"] >= st.session_state.scores["N"] else "N"
    mbti += "T" if st.session_state.scores["T"] >= st.session_state.scores["F"] else "F"
    mbti += "J" if st.session_state.scores["J"] >= st.session_state.scores["P"] else "P"

    st.subheader(f"🧠 당신의 MBTI는: {mbti}")

    MBTI_JOBS = {
        "ISTJ": ["회계사", "공무원", "군인"],
        "ISFJ": ["간호사", "사회복지사", "초등교사"],
        "INFJ": ["심리상담사", "기획자", "인권활동가"],
        "INTJ": ["개발자", "전략기획가", "연구원"],
        "ISTP": ["기술자", "파일럿", "경찰관"],
        "ISFP": ["예술가", "치료사", "인테리어디자이너"],
        "INFP": ["작가", "심리상담가", "NGO활동가"],
        "INTP": ["과학자", "데이터분석가", "이론가"],
        "ESTP": ["소방관", "기업 영업", "스포츠 트레이너"],
        "ESFP": ["연예인", "이벤트기획자", "메이크업아티스트"],
        "ENFP": ["마케터", "작가", "교육 콘텐츠 기획자"],
        "ENTP": ["창업가", "광고기획자", "변호사"],
        "ESTJ": ["경영자", "군 간부", "프로젝트매니저"],
        "ESFJ": ["영양사", "간호사", "교사"],
        "ENFJ": ["진로상담가", "홍보담당자", "리더십 코치"],
        "ENTJ": ["CEO", "전략컨설턴트", "정치가"]
    }

    st.markdown("### 🔎 추천 직업군:")
    for job in MBTI_JOBS.get(mbti, []):
        st.markdown(f"- {job}")

    st.markdown("---")
    st.caption("이 결과는 참고용이며, 자기 탐색의 방향을 제시합니다.")
